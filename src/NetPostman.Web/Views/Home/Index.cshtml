@{
    var workspace = Model as NetPostman.Web.ViewModels.WorkspaceViewModel;
    var activeWorkspaceId = workspace?.Id ?? Guid.Empty;
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NetPostman - API Testing Tool</title>
    <link rel="stylesheet" href="~/css/style.css" />
    <link rel="stylesheet" href="~/lib/codemirror/codemirror.css" />
    <link rel="stylesheet" href="~/lib/codemirror/dracula.css" />
</head>
<body>
    <div id="app">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
                    </svg>
                    <span>NetPostman</span>
                </div>
                <button class="btn-icon" onclick="toggleSidebar()" title="Collapse sidebar">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M2 4h12v2H2V4zm0 5h12v2H2V9zm0 5h12v2H2v-2z"/>
                    </svg>
                </button>
            </div>
            
            <div class="sidebar-tabs">
                <button class="tab-btn active" data-tab="collections" onclick="switchTab('collections')">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M14 2H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2zm0 10H2V4h12v8z"/>
                    </svg>
                    Collections
                </button>
                <button class="tab-btn" data-tab="history" onclick="switchTab('history')">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm0 14A6 6 0 1 1 8 2a6 6 0 0 1 0 12zm.5-7v3h-3v-3H8l3 3 3-3h-2.5z"/>
                    </svg>
                    History
                </button>
                <button class="tab-btn" data-tab="environments" onclick="switchTab('environments')">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 1a7 7 0 0 0-7 7v1H2a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1v-6a1 1 0 0 0-1-1h-1V8a7 7 0 0 0-7-7zm0 2a5 5 0 0 1 5 5v3H3v-3a5 5 0 0 1 5-5z"/>
                    </svg>
                    Environments
                </button>
            </div>
            
            <div class="sidebar-content" id="sidebar-content">
                <!-- Collections Tab -->
                <div id="tab-collections" class="tab-content active">
                    <div class="sidebar-section">
                        <div class="section-header">
                            <span>Collections</span>
                            <button class="btn-icon" onclick="showCreateCollectionModal()" title="Create collection">
                                <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                                    <path d="M8 6h5v2H8v5H6V8H1V6h5V1h2v5z"/>
                                </svg>
                            </button>
                        </div>
                        <div id="collections-list" class="items-list">
                            <!-- Collections will be loaded here -->
                            <div class="empty-state">No collections yet</div>
                        </div>
                    </div>
                </div>
                
                <!-- History Tab -->
                <div id="tab-history" class="tab-content">
                    <div class="sidebar-section">
                        <div class="section-header">
                            <span>History</span>
                            <div class="header-actions">
                                <button class="btn-icon" onclick="clearHistory()" title="Clear history">
                                    <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                                        <path d="M3 2a1 1 0 0 0-1 1v1H2a1 1 0 0 0 0 2h1v7a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V6h1a1 1 0 0 0 0-2h-1V3a1 1 0 0 0-1-1H3zm2 1h6v1H5V3zM4 6h6v7a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V6z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div id="history-list" class="items-list">
                            <!-- History will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <!-- Environments Tab -->
                <div id="tab-environments" class="tab-content">
                    <div class="sidebar-section">
                        <div class="section-header">
                            <span>Environments</span>
                            <button class="btn-icon" onclick="showCreateEnvironmentModal()" title="Create environment">
                                <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                                    <path d="M8 6h5v2H8v5H6V8H1V6h5V1h2v5z"/>
                                </svg>
                            </button>
                        </div>
                        <div id="environments-list" class="items-list">
                            <!-- Environments will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="sidebar-footer">
                <select id="active-environment" class="environment-select" onchange="changeEnvironment(this.value)">
                    <option value="">No Environment</option>
                </select>
            </div>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Request Panel -->
            <div class="request-panel">
                <div class="request-bar">
                    <div class="method-select-wrapper">
                        <select id="request-method" class="method-select" onchange="updateMethodColor()">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                            <option value="PUT">PUT</option>
                            <option value="PATCH">PATCH</option>
                            <option value="DELETE">DELETE</option>
                            <option value="HEAD">HEAD</option>
                            <option value="OPTIONS">OPTIONS</option>
                        </select>
                    </div>
                    <div class="url-input-wrapper">
                        <input type="text" id="request-url" class="url-input" placeholder="Enter request URL" autocomplete="off">
                    </div>
                    <button id="send-btn" class="btn btn-primary" onclick="sendRequest()">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M1 8l14 7-7-2-3 6 5 2z"/>
                        </svg>
                        Send
                    </button>
                    <button class="btn btn-secondary" onclick="saveRequest()" title="Save request">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.632-.632l2-5a.5.5 0 0 1 .11-.168l10-10z"/>
                        </svg>
                        Save
                    </button>
                </div>
                
                <div class="request-tabs">
                    <button class="request-tab active" data-tab="params" onclick="switchRequestTab('params')">Params</button>
                    <button class="request-tab" data-tab="headers" onclick="switchRequestTab('headers')">Headers</button>
                    <button class="request-tab" data-tab="body" onclick="switchRequestTab('body')">Body</button>
                    <button class="request-tab" data-tab="auth" onclick="switchRequestTab('auth')">Auth</button>
                    <button class="request-tab" data-tab="pre-request" onclick="switchRequestTab('pre-request')">Pre-request Script</button>
                    <button class="request-tab" data-tab="tests" onclick="switchRequestTab('tests')">Tests</button>
                </div>
                
                <div class="request-tab-content" id="request-tab-content">
                    <!-- Params Tab -->
                    <div id="tab-params" class="request-tab-panel active">
                        <div class="key-value-editor">
                            <div class="kv-header">
                                <span class="kv-key">Key</span>
                                <span class="kv-value">Value</span>
                                <span class="kv-actions">Actions</span>
                            </div>
                            <div id="params-list" class="kv-list">
                                <!-- Params will be added here -->
                            </div>
                            <button class="btn btn-small btn-secondary" onclick="addKeyValueRow('params-list')">+ Add Param</button>
                        </div>
                    </div>
                    
                    <!-- Headers Tab -->
                    <div id="tab-headers" class="request-tab-panel">
                        <div class="key-value-editor">
                            <div class="kv-header">
                                <span class="kv-key">Key</span>
                                <span class="kv-value">Value</span>
                                <span class="kv-actions">Actions</span>
                            </div>
                            <div id="headers-list" class="kv-list">
                                <!-- Headers will be added here -->
                            </div>
                            <button class="btn btn-small btn-secondary" onclick="addKeyValueRow('headers-list')">+ Add Header</button>
                        </div>
                    </div>
                    
                    <!-- Body Tab -->
                    <div id="tab-body" class="request-tab-panel">
                        <div class="body-options">
                            <div class="body-type-selector">
                                <label>
                                    <input type="radio" name="bodyType" value="none" checked onchange="updateBodyType('none')">
                                    <span>None</span>
                                </label>
                                <label>
                                    <input type="radio" name="bodyType" value="form-data" onchange="updateBodyType('form-data')">
                                    <span>form-data</span>
                                </label>
                                <label>
                                    <input type="radio" name="bodyType" value="urlencoded" onchange="updateBodyType('urlencoded')">
                                    <span>x-www-form-urlencoded</span>
                                </label>
                                <label>
                                    <input type="radio" name="bodyType" value="raw" onchange="updateBodyType('raw')">
                                    <span>raw</span>
                                </label>
                            </div>
                            <select id="body-content-type" class="content-type-select" onchange="updateBodyContentType()">
                                <option value="json">JSON</option>
                                <option value="text">Text</option>
                                <option value="xml">XML</option>
                                <option value="html">HTML</option>
                                <option value="javascript">JavaScript</option>
                            </select>
                        </div>
                        <div id="body-editor-container" class="body-editor-container" style="display: none;">
                            <textarea id="body-editor" class="code-editor" placeholder="Enter request body"></textarea>
                        </div>
                        <div id="body-form-data-container" class="form-data-container" style="display: none;">
                            <div class="key-value-editor">
                                <div class="kv-header">
                                    <span class="kv-key">Key</span>
                                    <span class="kv-value">Value</span>
                                    <span class="kv-type">Type</span>
                                    <span class="kv-actions">Actions</span>
                                </div>
                                <div id="form-data-list" class="kv-list"></div>
                                <button class="btn btn-small btn-secondary" onclick="addFormDataRow()">+ Add Field</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Auth Tab -->
                    <div id="tab-auth" class="request-tab-panel">
                        <div class="auth-options">
                            <div class="auth-type-selector">
                                <label>
                                    <input type="radio" name="authType" value="none" checked onchange="updateAuthType('none')">
                                    <span>None</span>
                                </label>
                                <label>
                                    <input type="radio" name="authType" value="bearer" onchange="updateAuthType('bearer')">
                                    <span>Bearer Token</span>
                                </label>
                                <label>
                                    <input type="radio" name="authType" value="basic" onchange="updateAuthType('basic')">
                                    <span>Basic Auth</span>
                                </label>
                            </div>
                            <div id="bearer-auth-container" class="auth-container" style="display: none;">
                                <input type="text" id="bearer-token" class="auth-input" placeholder="Enter bearer token">
                            </div>
                            <div id="basic-auth-container" class="auth-container" style="display: none;">
                                <input type="text" id="basic-username" class="auth-input" placeholder="Username">
                                <input type="password" id="basic-password" class="auth-input" placeholder="Password">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pre-request Script Tab -->
                    <div id="tab-pre-request" class="request-tab-panel">
                        <div class="script-editor-container">
                            <div class="script-description">
                                Enter JavaScript code to execute before the request is sent. Use <code>pm.environment.set("variable", "value")</code> to set variables.
                            </div>
                            <textarea id="pre-request-editor" class="code-editor script-editor" placeholder="// Pre-request script
pm.environment.set('timestamp', new Date().toISOString());"></textarea>
                        </div>
                    </div>
                    
                    <!-- Tests Tab -->
                    <div id="tab-tests" class="request-tab-panel">
                        <div class="script-editor-container">
                            <div class="script-description">
                                Enter JavaScript tests to validate the response. Use <code>pm.test("test name", function() { ... })</code>.
                            </div>
                            <textarea id="tests-editor" class="code-editor script-editor" placeholder="// Tests
pm.test('Status code is 200', function() {
    pm.response.to.have.status(200);
});"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Response Panel -->
            <div class="response-panel" id="response-panel">
                <div class="response-header">
                    <div class="response-status">
                        <span id="response-status" class="status-badge"></span>
                        <span id="response-time" class="response-metric"></span>
                        <span id="response-size" class="response-metric"></span>
                    </div>
                    <div class="response-actions">
                        <button class="btn btn-small" onclick="copyResponse()">Copy</button>
                        <button class="btn btn-small" onclick="clearResponse()">Clear</button>
                    </div>
                </div>
                
                <div class="response-tabs">
                    <button class="response-tab active" data-tab="response-body" onclick="switchResponseTab('response-body')">Body</button>
                    <button class="response-tab" data-tab="response-cookies" onclick="switchResponseTab('response-cookies')">Cookies</button>
                    <button class="response-tab" data-tab="response-headers" onclick="switchResponseTab('response-headers')">Headers</button>
                    <button class="response-tab" data-tab="response-tests" onclick="switchResponseTab('response-tests')">Test Results</button>
                </div>
                
                <div class="response-content" id="response-content">
                    <div id="tab-response-body" class="response-tab-panel active">
                        <div class="response-body-container">
                            <pre id="response-body" class="response-body"></pre>
                        </div>
                    </div>
                    <div id="tab-response-cookies" class="response-tab-panel">
                        <div id="response-cookies" class="cookies-list"></div>
                    </div>
                    <div id="tab-response-headers" class="response-tab-panel">
                        <div id="response-headers" class="headers-list"></div>
                    </div>
                    <div id="tab-response-tests" class="response-tab-panel">
                        <div id="test-results" class="test-results"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Modals -->
    <div id="modal-overlay" class="modal-overlay" style="display: none;" onclick="closeModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 id="modal-title">Modal Title</h3>
                <button class="btn-icon" onclick="closeModal()">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- Modal content will be inserted here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                <button class="btn btn-primary" id="modal-confirm-btn" onclick="confirmModal()">Confirm</button>
            </div>
        </div>
    </div>
    
    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>
    
    <script src="~/lib/codemirror/codemirror.js"></script>
    <script src="~/lib/codemirror/javascript.js"></script>
    <script src="~/lib/codemirror/xml.js"></script>
    <script src="~/lib/codemirror/json.js"></script>
    <script src="~/js/app.js"></script>
</body>
</html>
